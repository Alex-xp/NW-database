var PGSQL_LIB=require("./build/Release/pgsql_lib.node");PGSQL_LIB.Version=function(){return this.c_Version()},PGSQL_LIB.conn=!1,PGSQL_LIB.conn_string="dbname=base host=localhost port=5432 user=postgres password=my_password",PGSQL_LIB.Connect=function(a){var b=a||PGSQL_LIB.conn_string;return this.c_Connect(b)?(this.conn=!0,!0):(this.debug&&window.alert("НЕ МОГУ СОЕДИНИТСЯ С БАЗОЙ"),this.conn=!1,!1)},PGSQL_LIB.Close=function(){this.conn&&(this.c_Close(),this.conn=!1)},PGSQL_LIB.debug=!0,PGSQL_LIB.ErrorMsg="",PGSQL_LIB.Error=function(){return this.ErrorMsg="",this.c_isError()!==!1?(this.ErrorMsg=this.c_ErrorMsg(),this.debug&&window.alert(this.ErrorMsg),this.c_ErrorMsg()):""},PGSQL_LIB.isError=function(){return this.c_isError()&&this.Error(),this.c_isError()},PGSQL_LIB.RESULT=function(){return this.result=Array(),this.rows_count=0,this.filelds_count=0,this.fields_names=Array(),this.getForName=function(a,b){return this.result[a][b]},this.get=function(a,b){var c=this.fields_names[b];return this.result[a][c]},this.getFName=function(a){return this.fields_names[a]},this},PGSQL_LIB.Exec=function(a){return this.c_Query(a),this.isError()?!1:!0},PGSQL_LIB.Query=function(a){if(PGSQL_LIB.c_Query(a),PGSQL_LIB.isError())return!1;for(var b=new PGSQL_LIB.RESULT,c=PGSQL_LIB.c_rows_count(),d=PGSQL_LIB.c_fields_count(),e=0;c>e;e++){for(var f=new Object,g=0;d>g;g++)f[PGSQL_LIB.c_getFName(g)]=PGSQL_LIB.c_get(e,g);b.result[e]=f}b.rows_count=c,b.filelds_count=d,b.fields_names=Array();for(var g=0;d>g;g++)b.fields_names[g]=PGSQL_LIB.c_getFName(g);return b},PGSQL_LIB.WHERE=function(a){return this.__where=""+a,this.ins=function(a){return this.__where=this.__where+"("+a+") ",this},this.add=function(a){return this.__where=this.__where+a,this},this._AND=function(){return this.__where=this.__where+" AND ",this},this._OR=function(){return this.__where=this.__where+" OR ",this},this._XOR=function(){return this.__where=this.__where+" XOR ",this},this._LIKE=function(){return this.__where=this.__where+" LIKE ",this},this.insAND=function(a){return this.__where=this.__where+" AND("+a.__where+") ",this},this.insOR=function(a){return this.__where=this.__where+" OR("+a.__where+") ",this},this.insXOR=function(a){return this.__where=this.__where+" XOR("+a.__where+") ",this},this.insLIKE=function(a){return this.__where=this.__where+" LIKE("+a.__where+") ",this},this.AND=function(a){return this.__where=this.__where+" AND "+a+" ",this},this.OR=function(a){return this.__where=this.__where+" OR "+a+" ",this},this.XOR=function(a){return this.__where=this.__where+" XOR "+a+" ",this},this.LIKE=function(a,b){return this.__where=this.__where+" "+a+" LIKE %"+b+"% ",this},this},PGSQL_LIB.F_TEXT="TEXT ",PGSQL_LIB.F_INT="INTEGER ",PGSQL_LIB.F_PK="PRIMARY KEY ",PGSQL_LIB.F_NUM="NUMERIC ",PGSQL_LIB.F_FLOAT="REAL ",PGSQL_LIB.F_UNIQUE="UNIQUE ",PGSQL_LIB.F_NONE="NONE ",PGSQL_LIB.F_ASC="ASC ",PGSQL_LIB.F_DESC="DESC ",PGSQL_LIB.F_NOT_NULL="NOT NULL ",PGSQL_LIB.FIELD=function(a){return this.fname=a.name||"noName",this.type="",void 0===a.type?this.type="":this.type=" "+a.type,this.__getSQL=function(){return this.fname+this.type},this},PGSQL_LIB.SQL=function(){this.sql="",this.__isRes=!0,this.__tables=[],this.table=function(a){return this.__tables=null,this.__tables=[],this.__tables[0]=a,this},this.tables=function(a){this.__tables=null,this.__tables=[];for(var b=0;b<a.length;b++)this.__tables[b]=a[b];return this},this.__fields=[],this.select=function(a){this.__isRes=!0,this.__fields=null,this.__fields=a;for(var b="SELECT ",c=0;c<a.length;c++)b+=a[c],c<a.length-1&&(b+=","),b+=" ";b+="FROM ";for(var c=0;c<this.__tables.length;c++)b+=this.__tables[c],c<this.__tables.length-1&&(b+=","),b+=" ";return this.sql=b,this},this.create=function(a,b){this._NE="",void 0!==b&&b!==!1&&(this._NE="IF NOT EXISTS "),this.__isRes=!1;for(var c="CREATE TABLE "+this._NE,d=0;d<this.__tables.length;d++)c+=this.__tables[d],d<this.__tables.length-1&&(c+=","),c+=" ";if(c+="(","string"==typeof a)c+=a;else for(var d=0;d<a.length;d++)c+=a[d].__getSQL(),d<a.length-1&&(c+=","),c+=" ";return c+=")",this.sql=c,this},this.drop_table=function(a,b){return this._NE="",void 0!==b&&b!==!1&&(this._NE="IF EXISTS "),this.sql="DROP TABLE "+this._NE+a,this},this.insert=function(a){this.__isRes=!1;for(var b="INSERT INTO ",c=0;c<this.__tables.length;c++)b+=this.__tables[c],c<this.__tables.length-1&&(b+=","),b+=" ";if("string"==typeof a)b=a;else{b+="(";var d=0;for(var e in a)d>0&&(b+=", "),b+=e,d++;b+=") VALUES (";var d=0;for(var e in a)d>0&&(b+=", "),b=b+"'"+a[e].replace(/'/g,"&#39;")+"'",d++;b+=")"}return this.sql=b,this},this.update=function(a){this.__isRes=!1;for(var b="UPDATE ",c=0;c<this.__tables.length;c++)b+=this.__tables[c],c<this.__tables.length-1&&(b+=","),b+=" ";var b=b+"SET ",d=0;for(fx in a)d>0&&(b+=","),b+=" ",b=b+fx+"='"+a[fx].replace(/'/g,"&#39;")+"'",d++;return b+=" ",this.sql=b,this},this.where=function(a){var b="";return b="string"==typeof a?"WHERE "+a+" ":"WHERE "+a.__where,this.sql=this.sql+b,this},this.limit=function(a,b){var c=b||"";return""!==c&&(c=","+b),this.sql=this.sql+"LIMIT "+a+c+" ",this},this.order_by=function(a){for(var b="ORDER BY ",c=0;c<a.length;c++)b+=a[c],c<a.length-1&&(b+=","),b+=" ";return this.sql=this.sql+b,this},this.exec=function(a){var b=a||"",c=null;return c=this.__isRes?PGSQL_LIB.Query(this.sql+b):PGSQL_LIB.Exec(this.sql+b)}},module.exports=PGSQL_LIB;